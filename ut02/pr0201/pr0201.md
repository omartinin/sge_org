# PR0201

## 1. `docker-compose.yml`

```yaml
services:
  postgres:
    image: postgres:14
    container_name: db
    environment:
      - POSTGRES_DB=postgres
      - POSTGRES_USER=odoo
      - POSTGRES_PASSWORD=paso
    volumes:
      - ./OdooDev/dataPG:/var/lib/postgresql/data
  odoo:
    image: odoo:16
    container_name: odoo_16
    environment:
      - HOST=postgres
      - USER=odoo
      - PASSWORD=paso
    ports:
      - '8069:8069'
    volumes:
      - ./OdooDev/volumesOdoo/addons:/mnt/extra-addons
      - ./OdooDev/volumesOdoo/filestore:/var/lib/odoo/filestore
      - ./OdooDev/volumesOdoo/sessions:/var/lib/odoo/sessions
    depends_on:
      - postgres
    command: --dev=all

  postgresprod:
    image: postgres:14
    container_name: dbprod
    environment:
      - POSTGRES_DB=postgres
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=paso
  odooprod:
    image: odoo:16
    container_name: odoo_16_prod
    environment:
      - HOST=postgresprod
      - USER=root
      - PASSWORD=paso
    ports:
      - '8070:8069'
    volumes:
      - ./OdooProd/addons:/mnt/extra-addons
    depends_on:
      - postgresprod
```
## 2. Estructura de carpetas creada
```
OdooDev/
├─ dataPG/                 # Datos de Postgres (desarrollo)
└─ volumesOdoo/
   ├─ addons/              # Módulos extra para desarrollo
   ├─ filestore/           # Archivos generados por Odoo
   └─ sessions/            # Sesiones de Odoo

OdooProd/
└─ addons/                 # Único volumen permitido en producción
```
---
## 3. Explicación del archivo `docker-compose.yml`

El archivo define **cuatro servicios**:

### **Servicios de desarrollo:**
- **postgres**: base de datos para desarrollo. Su volumen `dataPG` guarda los datos de Postgres.
- **odoo**: instancia de Odoo en modo desarrollo. Se mapean **tres volúmenes**:
  - `addons/` para cargar módulos personalizados.
  - `filestore/` donde Odoo guarda archivos.
  - `sessions/` persistencia de sesiones.

### **Servicios de producción:**
- **postgresprod**: base de datos separada para producción.
- **odooprod**: versión de Odoo para producción. Solo mapea:
  - `addons/`

### **Otros aspectos importantes:**
- `HOST`, `USER` y `PASSWORD` permiten que cada Odoo se conecte a su Postgres correspondiente.
- `depends_on` asegura que Odoo arranca cuando la base de datos ya está lista.
- `--dev=all` le indica al contenedor de Odoo que arranque el servidor en modo desarrollo.
- Se asignan puertos diferentes para evitar conflictos:
  - **8069** desarrollo
  - **8070** producción
---

## 4. Comando para levantar los contenedores

Ejecutar desde el directorio que contiene `compose.yml`:

```bash
docker compose up -d
```

