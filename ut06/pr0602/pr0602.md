# PR0602

## 1. Personalización del módulo

- Creamos los modelos:

    `library_org_autor.py`
    ```
    # -*- coding: utf-8 -*-

    from odoo import models, fields, api


    class library_org_autor(models.Model):
        _name = 'library_org.library_org_autor'
        _description = 'library_org.library_org_autor'

        nombre = fields.Char()
        pais = fields.Many2one(
            'res.country', 
            string='País de origen'
        )
        libros = fields.One2many(
            comodel_name='library_org.library_org_libro',
            inverse_name='autor',
        )
    ```

    `library_org_libro.py`
    ```
    # -*- coding: utf-8 -*-

    from odoo import models, fields, api


    class library_org_libro(models.Model):
        _name = 'library_org.library_org_libro'
        _description = 'library_org.library_org_libro'

        titulo = fields.Char()
        autor = fields.Many2one(
            comodel_name='library_org.library_org_autor',
            ondelete='restrict',
        )
        
        genero = fields.Selection(
            string='Género',
            selection=[('novela', 'Novela'),
                        ('drama', 'Drama'),
                        ('ciencia_ficcion', 'Ciencia ficción'),
                        ('misterio','Misterio'),
                        ('terror','Terror'),
                        ('historico','Histórico')]
        )
        socios = fields.Many2many(
            comodel_name='library_org.library_org_socio',
            relation='libro_socio',
            column1='nombre',
            column2='titulo',
        )
    ```

    `library_org_socio.py`
    ```
    # -*- coding: utf-8 -*-

    from odoo import models, fields, api


    class library_org_socio(models.Model):
        _name = 'library_org.library_org_socio'
        _description = 'library_org.library_org_socio'

        nombre = fields.Char()
        libros = fields.Many2many(
            comodel_name='library_org.library_org_libro',
            relation='libro_socio',
            column1='titulo',
            column2='nombre',
        )
    ```

- Importamos los modelos:

    `__init__.py`
    ```
    # -*- coding: utf-8 -*-

    from . import library_org_autor
    from . import library_org_libro
    from . import library_org_socio
    ```

- Creamos las views:
  
    `autor_view.xml`
    ```
    <odoo>      
        <data>
            <record model="ir.ui.view" id="library_org.list_autor">
                <field name="name">Autores</field>
                <field name="model">library_org.library_org_autor</field>
                <field name="arch" type="xml">
                    <tree>
                        <field name="nombre"/>
                        <field name="pais"/>
                        <field name="libros"/>
                    </tree>
                </field>
            </record>

            <record model="ir.actions.act_window" id="library_org.action_autores">
                <field name="name">Autores</field>
                <field name="res_model">library_org.library_org_autor</field>
                <field name="view_mode">tree,form</field>
            </record>
        </data>
    </odoo>  
    ```

    `libro_view.xml`
    ```
    <odoo>      
        <data>           
            <record model="ir.ui.view" id="library_org.list_libro">
                <field name="name">Libros</field>
                <field name="model">library_org.library_org_libro</field>
                <field name="arch" type="xml">
                    <tree>
                        <field name="titulo"/>
                        <field name="autor"/>
                        <field name="genero"/>
                        <field name="socios"/>
                    </tree>
                </field>
            </record>

            <record model="ir.actions.act_window" id="library_org.action_libros">
                <field name="name">Libros</field>
                <field name="res_model">library_org.library_org_libro</field>
                <field name="view_mode">tree,form</field>
            </record>
        </data>
    </odoo> 
    ```

    `socio_view.xml`
    ```
    <odoo>      
        <data>           
            <record model="ir.ui.view" id="library_org.list_socio">
                <field name="name">Socios</field>
                <field name="model">library_org.library_org_socio</field>
                <field name="arch" type="xml">
                    <tree>
                        <field name="nombre"/>
                        <field name="libros"/>
                    </tree>
                </field>
            </record>

            <record model="ir.actions.act_window" id="library_org.action_socios">
                <field name="name">Socios</field>
                <field name="res_model">library_org.library_org_socio</field>
                <field name="view_mode">tree,form</field>
            </record>
        </data>
    </odoo>  
    ```

    `menu_view.py`
    ```
    <odoo>      
        <data>    
            <!-- Top menu item -->

            <menuitem name="library_org" id="library_org.menu_root"/>

            <!-- menu categories -->

            <menuitem name="Libros" id="library_org.libros" parent="library_org.menu_root"/>
            <menuitem name="Autores" id="library_org.autores" parent="library_org.menu_root"/>
            <menuitem name="Socios" id="library_org.socios" parent="library_org.menu_root"/>

            <!-- actions -->

            <menuitem name="Lista de libros" id="library_org.libros_list" parent="library_org.libros"
                    action="library_org.action_libros"/>
            <menuitem name="Lista de autores" id="library_org.autores_list" parent="library_org.autores"
                    action="library_org.action_autores"/>
            <menuitem name="Lista de socios" id="library_org.socios_list" parent="library_org.socios"
                    action="library_org.action_socios"/>
        </data>
    </odoo>  
    ```

- Añadimos las views en el manifiesto:
  
    `__manifest__.py`
    ```
    # -*- coding: utf-8 -*-
    {
        'name': "library_org",

        'summary': """
            Short (1 phrase/line) summary of the module's purpose, used as
            subtitle on modules listing or apps.openerp.com""",

        'description': """
            Long description of module's purpose
        """,

        'author': "My Company",
        'website': "https://www.yourcompany.com",

        # Categories can be used to filter modules in modules listing
        # Check https://github.com/odoo/odoo/blob/16.0/odoo/addons/base/data/ir_module_category_data.xml
        # for the full list
        'category': 'Uncategorized',
        'version': '0.1',

        # any module necessary for this one to work correctly
        'depends': ['base'],

        # always loaded
        'data': [
            'security/ir.model.access.csv',
            'views/autor_view.xml',
            'views/libro_view.xml',
            'views/socio_view.xml',
            'views/menu_view.xml',
        ],
        # only loaded in demonstration mode
        'demo': [
            'demo/demo.xml',
        ],
    }
    ```

- Definimos los permisos de acceso a modelos:
  
    `ir.model.access.csv`
    ```
    id,name,model_id:id,group_id:id,perm_read,perm_write,perm_create,perm_unlink
    access_library_org_library_org_libro,library_org.library_org_libro,model_library_org_library_org_libro,base.group_user,1,1,1,1
    access_library_org_library_org_autor,library_org.library_org_autor,model_library_org_library_org_autor,base.group_user,1,1,1,1
    access_library_org_library_org_socio,library_org.library_org_socio,model_library_org_library_org_socio,base.group_user,1,1,1,1
    ```

## 2. Capturas

- [Libro](./capturas/capturaLibro.png)
- [Autor](./capturas/capturaAutor.png)
- [Socio](./capturas/capturaSocio.png)